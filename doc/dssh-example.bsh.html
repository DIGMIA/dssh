<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
    <meta http-equiv="content-type" content="text/html; charset=ISO-8859-1" />
    <meta name="generator" content="JHighlight v1.0 (http://jhighlight.dev.java.net)" />
    <title>dssh-example.bsh</title>
    <link rel="Help" href="http://jhighlight.dev.java.net" />
    <style type="text/css">
.java_type {
color: rgb(0,44,221);
}
.java_keyword {
color: rgb(0,0,0); font-weight: bold;
}
.java_javadoc_comment {
color: rgb(147,147,147); background-color: rgb(247,247,247); font-style: italic;
}
.java_comment {
color: rgb(147,147,147); background-color: rgb(247,247,247);
}
.java_operator {
color: rgb(0,124,31);
}
.java_plain {
color: rgb(0,0,0);
}
.java_literal {
color: rgb(188,0,0);
}
code {
color: rgb(0,0,0); font-family: monospace; font-size: 12px; white-space: nowrap;
}
.java_javadoc_tag {
color: rgb(147,147,147); background-color: rgb(247,247,247); font-style: italic; font-weight: bold;
}
.java_separator {
color: rgb(0,33,255);
}
h1 {
font-family: sans-serif; font-size: 16pt; font-weight: bold; color: rgb(0,0,0); background: rgb(210,210,210); border: solid 1px black; padding: 5px; text-align: center;
}
    </style>
</head>
<body>
<h1>dssh-example.bsh</h1><code><span class="java_keyword">import</span><span class="java_plain">&nbsp;dssh</span><span class="java_separator">.</span><span class="java_operator">*</span><span class="java_separator">;</span><span class="java_plain"></span><br />
<span class="java_keyword">import</span><span class="java_plain">&nbsp;dssh</span><span class="java_separator">.</span><span class="java_plain">authenticators</span><span class="java_separator">.</span><span class="java_plain">password</span><span class="java_separator">.</span><span class="java_type">PasswordAuthenticator</span><span class="java_separator">;</span><span class="java_plain"></span><br />
<span class="java_keyword">import</span><span class="java_plain">&nbsp;dssh</span><span class="java_separator">.</span><span class="java_plain">exceptions</span><span class="java_separator">.</span><span class="java_operator">*</span><span class="java_separator">;</span><span class="java_plain"></span><br />
<span class="java_keyword">import</span><span class="java_plain">&nbsp;java</span><span class="java_separator">.</span><span class="java_plain">net</span><span class="java_separator">.</span><span class="java_operator">*</span><span class="java_separator">;</span><span class="java_plain"></span><br />
<span class="java_keyword">import</span><span class="java_plain">&nbsp;java</span><span class="java_separator">.</span><span class="java_plain">util</span><span class="java_separator">.</span><span class="java_plain">regex</span><span class="java_separator">.</span><span class="java_type">Pattern</span><span class="java_separator">;</span><span class="java_plain"></span><br />
<span class="java_keyword">import</span><span class="java_plain">&nbsp;java</span><span class="java_separator">.</span><span class="java_plain">util</span><span class="java_separator">.</span><span class="java_plain">regex</span><span class="java_separator">.</span><span class="java_type">Matcher</span><span class="java_separator">;</span><span class="java_plain"></span><br />
<span class="java_plain"></span><br />
<span class="java_plain"></span><br />
<span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_keyword">class</span><span class="java_plain">&nbsp;dssh&nbsp;</span><span class="java_keyword">implements</span><span class="java_plain">&nbsp;</span><span class="java_type">SSHConnectionCreator</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain"></span><br />
<span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;verbose&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">false</span><span class="java_separator">;</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_comment">//&nbsp;Called&nbsp;by&nbsp;DSSH&nbsp;to&nbsp;inform&nbsp;us&nbsp;if&nbsp;we&nbsp;should&nbsp;be&nbsp;verbose&nbsp;or&nbsp;not</span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">void</span><span class="java_plain">&nbsp;setVerbose</span><span class="java_separator">(</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;verbose</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">this</span><span class="java_separator">.</span><span class="java_plain">verbose&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;verbose</span><span class="java_separator">;</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span><span class="java_plain"></span><br />
<span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_comment">//&nbsp;utility&nbsp;function&nbsp;for&nbsp;regexp&nbsp;match</span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">private</span><span class="java_plain">&nbsp;</span><span class="java_type">boolean</span><span class="java_plain">&nbsp;regexMatches</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;where</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;regexp</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;</span><span class="java_type">Pattern</span><span class="java_separator">.</span><span class="java_plain">compile</span><span class="java_separator">(</span><span class="java_literal">&quot;.*&quot;</span><span class="java_plain">&nbsp;</span><span class="java_operator">+</span><span class="java_plain">&nbsp;regexp&nbsp;</span><span class="java_operator">+</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;.*&quot;</span><span class="java_separator">).</span><span class="java_plain">matcher</span><span class="java_separator">(</span><span class="java_plain">where</span><span class="java_separator">).</span><span class="java_plain">matches</span><span class="java_separator">();</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span><span class="java_plain"></span><br />
<span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_comment">//&nbsp;Let's&nbsp;create&nbsp;authenticated&nbsp;connection</span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">SSHConnection</span><span class="java_plain">&nbsp;getAuthenticatedSSHConnection</span><span class="java_separator">(</span><span class="java_type">String</span><span class="java_plain">&nbsp;username</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;host</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">int</span><span class="java_plain">&nbsp;port</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">SSHConnection</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;par</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">SSHAuthenticator</span><span class="java_plain">&nbsp;auth</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_comment">/*&nbsp;&quot;par&quot;&nbsp;contains&nbsp;parent&nbsp;connection&nbsp;(if&nbsp;we&nbsp;do&nbsp;SSH&nbsp;over&nbsp;SSH&nbsp;tunneling).</span><br />
<span class="java_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DSSH&nbsp;would&nbsp;call&nbsp;this&nbsp;method&nbsp;with&nbsp;par&nbsp;=&nbsp;null,&nbsp;but&nbsp;we&nbsp;can&nbsp;use&nbsp;this</span><br />
<span class="java_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;method&nbsp;ourselves&nbsp;recursively,&nbsp;see&nbsp;below&nbsp;*/</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">SSHConnection</span><span class="java_plain">&nbsp;parent&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;par</span><span class="java_separator">;</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;user&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;username</span><span class="java_separator">;</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;myuser&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_type">System</span><span class="java_separator">.</span><span class="java_plain">getenv</span><span class="java_separator">(</span><span class="java_literal">&quot;USER&quot;</span><span class="java_separator">);</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;orighost&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;host</span><span class="java_separator">;</span><span class="java_plain"></span><br />
<span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_comment">//&nbsp;let's&nbsp;start&nbsp;by&nbsp;simple&nbsp;examples.&nbsp;machine1.example.com&nbsp;does&nbsp;not&nbsp;listen&nbsp;on&nbsp;port</span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_comment">//&nbsp;22,&nbsp;but&nbsp;on&nbsp;port&nbsp;31337,&nbsp;so&nbsp;we'll&nbsp;fix&nbsp;this&nbsp;here,&nbsp;so&nbsp;user&nbsp;does&nbsp;not&nbsp;have&nbsp;to&nbsp;pass&nbsp;-p&nbsp;31337</span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_comment">//&nbsp;to&nbsp;DSSH</span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">((</span><span class="java_plain">host</span><span class="java_separator">.</span><span class="java_plain">equals</span><span class="java_separator">(</span><span class="java_literal">&quot;machine1.example.com&quot;</span><span class="java_separator">))</span><span class="java_plain">&nbsp;</span><span class="java_operator">&amp;&amp;</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">port&nbsp;</span><span class="java_operator">==</span><span class="java_plain">&nbsp;</span><span class="java_literal">22</span><span class="java_separator">))</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;port&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">31337</span><span class="java_separator">;</span><span class="java_plain"></span><br />
<span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_comment">/*&nbsp;let's&nbsp;continue&nbsp;with&nbsp;something&nbsp;more&nbsp;difficult.&nbsp;Hosts&nbsp;machine1.example.com&nbsp;and&nbsp;machine2.example.com,&nbsp;...</span><br />
<span class="java_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;have&nbsp;port&nbsp;22&nbsp;protected&nbsp;by&nbsp;firewall&nbsp;and&nbsp;allow&nbsp;connections&nbsp;only&nbsp;from&nbsp;gateway.example.com&nbsp;or</span><br />
<span class="java_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gateway2.example.com.&nbsp;So&nbsp;we'll&nbsp;first&nbsp;check&nbsp;if&nbsp;we&nbsp;are&nbsp;on&nbsp;one&nbsp;of&nbsp;these&nbsp;machines.&nbsp;If&nbsp;not,&nbsp;we</span><br />
<span class="java_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;connect&nbsp;to&nbsp;gateway.example.com&nbsp;and&nbsp;create&nbsp;our&nbsp;connection&nbsp;to&nbsp;target&nbsp;machine&nbsp;from&nbsp;there.</span><br />
<span class="java_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Please&nbsp;note,&nbsp;that&nbsp;we&nbsp;connect&nbsp;to&nbsp;gateway.example.com&nbsp;as&nbsp;user&nbsp;myuser,&nbsp;which&nbsp;contains</span><br />
<span class="java_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;content&nbsp;of&nbsp;USER&nbsp;environment&nbsp;variable,&nbsp;which&nbsp;should&nbsp;contain&nbsp;our&nbsp;username.&nbsp;This&nbsp;assumes,&nbsp;that</span><br />
<span class="java_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;you&nbsp;have&nbsp;the&nbsp;same&nbsp;account&nbsp;on&nbsp;local&nbsp;and&nbsp;target&nbsp;machine.&nbsp;You&nbsp;can&nbsp;as&nbsp;well&nbsp;connect&nbsp;as&nbsp;a</span><br />
<span class="java_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;particular&nbsp;user&nbsp;to&nbsp;the&nbsp;gateway&nbsp;machine.</span><br />
<span class="java_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br />
<span class="java_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note:&nbsp;we&nbsp;use&nbsp;this&nbsp;exact&nbsp;function&nbsp;to&nbsp;get&nbsp;to&nbsp;gateway.example.com</span><br />
<span class="java_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">((</span><span class="java_plain">host</span><span class="java_separator">.</span><span class="java_plain">equals</span><span class="java_separator">(</span><span class="java_literal">&quot;machine1.example.com&quot;</span><span class="java_separator">))</span><span class="java_plain">&nbsp;</span><span class="java_operator">||</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">host</span><span class="java_separator">.</span><span class="java_plain">equals</span><span class="java_separator">(</span><span class="java_literal">&quot;machine2.example.com&quot;</span><span class="java_separator">))</span><span class="java_plain">&nbsp;</span><span class="java_operator">||</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">host</span><span class="java_separator">.</span><span class="java_plain">equals</span><span class="java_separator">(</span><span class="java_literal">&quot;fw1.example2.com&quot;</span><span class="java_separator">))</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">&amp;&amp;</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">((</span><span class="java_type">System</span><span class="java_separator">.</span><span class="java_plain">getenv</span><span class="java_separator">(</span><span class="java_literal">&quot;HOSTNAME&quot;</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_operator">==</span><span class="java_plain">&nbsp;</span><span class="java_literal">null</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_operator">||</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_operator">!</span><span class="java_separator">(</span><span class="java_type">System</span><span class="java_separator">.</span><span class="java_plain">getenv</span><span class="java_separator">(</span><span class="java_literal">&quot;HOSTNAME&quot;</span><span class="java_separator">).</span><span class="java_plain">equals</span><span class="java_separator">(</span><span class="java_literal">&quot;gateway.example.com&quot;</span><span class="java_separator">))</span><span class="java_plain">&nbsp;</span><span class="java_operator">&amp;&amp;</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">(</span><span class="java_operator">!</span><span class="java_type">System</span><span class="java_separator">.</span><span class="java_plain">getenv</span><span class="java_separator">(</span><span class="java_literal">&quot;HOSTNAME&quot;</span><span class="java_separator">).</span><span class="java_plain">equals</span><span class="java_separator">(</span><span class="java_literal">&quot;gateway2.example.com&quot;</span><span class="java_separator">)))))</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;getAuthenticatedSSHConnection</span><span class="java_separator">(</span><span class="java_plain">myuser</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;gateway.example.com&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">22</span><span class="java_separator">,</span><span class="java_plain">&nbsp;parent</span><span class="java_separator">,</span><span class="java_plain">&nbsp;auth</span><span class="java_separator">);</span><span class="java_plain"></span><br />
<span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_comment">/*&nbsp;These&nbsp;machines&nbsp;don't&nbsp;allow&nbsp;root&nbsp;login,&nbsp;so&nbsp;just&nbsp;for&nbsp;now&nbsp;log&nbsp;in&nbsp;as&nbsp;user&nbsp;&quot;adminuser&quot;.&nbsp;Later&nbsp;(when</span><br />
<span class="java_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;DSSH&nbsp;requests&nbsp;interactive&nbsp;session),&nbsp;we&nbsp;will&nbsp;use&nbsp;command&nbsp;&quot;su&nbsp;-&quot;&nbsp;and&nbsp;type&nbsp;password&nbsp;from&nbsp;agent.&nbsp;*/</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">&nbsp;</span><span class="java_separator">((</span><span class="java_plain">host</span><span class="java_separator">.</span><span class="java_plain">equals</span><span class="java_separator">(</span><span class="java_literal">&quot;machine3.example.com&quot;</span><span class="java_separator">))</span><span class="java_plain">&nbsp;</span><span class="java_operator">||</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">host</span><span class="java_separator">.</span><span class="java_plain">equals</span><span class="java_separator">(</span><span class="java_literal">&quot;machine4.example.com&quot;</span><span class="java_separator">))</span><span class="java_plain">&nbsp;</span><span class="java_operator">||</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">host</span><span class="java_separator">.</span><span class="java_plain">equals</span><span class="java_separator">(</span><span class="java_literal">&quot;machine5.example.com&quot;</span><span class="java_separator">)))</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_operator">&amp;&amp;</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">user</span><span class="java_separator">.</span><span class="java_plain">equals</span><span class="java_separator">(</span><span class="java_literal">&quot;root&quot;</span><span class="java_separator">))</span><span class="java_plain">&nbsp;</span><span class="java_separator">)</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;user&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;adminuser&quot;</span><span class="java_separator">;</span><span class="java_plain"></span><br />
<span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_comment">/*&nbsp;This&nbsp;host's&nbsp;DNS&nbsp;entry&nbsp;does&nbsp;not&nbsp;actually&nbsp;exist,&nbsp;it's&nbsp;on&nbsp;a&nbsp;private&nbsp;address&nbsp;and&nbsp;can&nbsp;be&nbsp;reached&nbsp;only&nbsp;from</span><br />
<span class="java_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;gateway.example.com&nbsp;as&nbsp;seen&nbsp;above.&nbsp;machine2.example.com&nbsp;is&nbsp;just&nbsp;fake&nbsp;hostname,&nbsp;we&nbsp;will&nbsp;replace&nbsp;it&nbsp;with</span><br />
<span class="java_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;IP&nbsp;address.&nbsp;(Note:&nbsp;if&nbsp;you&nbsp;create&nbsp;DNS&nbsp;or&nbsp;/etc/hosts&nbsp;entry&nbsp;on&nbsp;gateway.example.com,&nbsp;which&nbsp;resolves</span><br />
<span class="java_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;machine2.example.com,&nbsp;you&nbsp;don't&nbsp;have&nbsp;to&nbsp;do&nbsp;this.&nbsp;Resolving&nbsp;is&nbsp;done&nbsp;on&nbsp;parent&nbsp;connection,&nbsp;not&nbsp;on</span><br />
<span class="java_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;client&nbsp;side)&nbsp;&nbsp;*/</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">host</span><span class="java_separator">.</span><span class="java_plain">equals</span><span class="java_separator">(</span><span class="java_literal">&quot;machine2.example.com&quot;</span><span class="java_separator">))</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;host&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;192.168.1.6&quot;</span><span class="java_separator">;</span><span class="java_plain"></span><br />
<span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_comment">/*&nbsp;We&nbsp;handle&nbsp;anything,&nbsp;that&nbsp;contains&nbsp;.example2.com&nbsp;using&nbsp;this&nbsp;branch.&nbsp;It&nbsp;is&nbsp;a&nbsp;small&nbsp;network&nbsp;hidden</span><br />
<span class="java_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;by&nbsp;two&nbsp;firewalls.&nbsp;This&nbsp;should&nbsp;be&nbsp;pretty&nbsp;self-explanatory,&nbsp;if&nbsp;you&nbsp;understood&nbsp;examples&nbsp;above.</span><br />
<span class="java_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Note:&nbsp;fw1.example2.com&nbsp;is&nbsp;reachable&nbsp;only&nbsp;from&nbsp;gateway.example.com&nbsp;or&nbsp;gateway2.example.com&nbsp;(see&nbsp;above),</span><br />
<span class="java_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;so&nbsp;if&nbsp;we&nbsp;connect&nbsp;from&nbsp;somewhere&nbsp;else,&nbsp;this&nbsp;script&nbsp;will&nbsp;first&nbsp;log&nbsp;into&nbsp;gateway.example.com,&nbsp;then&nbsp;to</span><br />
<span class="java_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;fw1.example.com&nbsp;and&nbsp;then&nbsp;to&nbsp;target&nbsp;machine.&nbsp;Recursion&nbsp;is&nbsp;very&nbsp;useful&nbsp;here&nbsp;:)</span><br />
<span class="java_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;*/</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">regexMatches</span><span class="java_separator">(</span><span class="java_plain">host</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;\\.example2\\.com&quot;</span><span class="java_separator">))</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">((</span><span class="java_operator">!</span><span class="java_plain">host</span><span class="java_separator">.</span><span class="java_plain">equals</span><span class="java_separator">(</span><span class="java_literal">&quot;fw1.example2.com&quot;</span><span class="java_separator">))</span><span class="java_plain">&nbsp;</span><span class="java_operator">&amp;&amp;</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_operator">!</span><span class="java_plain">host</span><span class="java_separator">.</span><span class="java_plain">equals</span><span class="java_separator">(</span><span class="java_literal">&quot;fw2.example2.com&quot;</span><span class="java_separator">)))</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;parent&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;getAuthenticatedSSHConnection</span><span class="java_separator">(</span><span class="java_literal">&quot;adminuser&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;fw1.example2.com&quot;</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_literal">22</span><span class="java_separator">,</span><span class="java_plain">&nbsp;parent</span><span class="java_separator">,</span><span class="java_plain">&nbsp;auth</span><span class="java_separator">);</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">host</span><span class="java_separator">.</span><span class="java_plain">equals</span><span class="java_separator">(</span><span class="java_literal">&quot;www1.example2.com&quot;</span><span class="java_separator">))</span><span class="java_plain">&nbsp;host&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;192.168.121.220&quot;</span><span class="java_separator">;</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">host</span><span class="java_separator">.</span><span class="java_plain">equals</span><span class="java_separator">(</span><span class="java_literal">&quot;www2.example2.com&quot;</span><span class="java_separator">))</span><span class="java_plain">&nbsp;host&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;192.168.121.221&quot;</span><span class="java_separator">;</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">host</span><span class="java_separator">.</span><span class="java_plain">equals</span><span class="java_separator">(</span><span class="java_literal">&quot;www.example2.com&quot;</span><span class="java_separator">))</span><span class="java_plain">&nbsp;host&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;192.168.121.222&quot;</span><span class="java_separator">;</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">host</span><span class="java_separator">.</span><span class="java_plain">equals</span><span class="java_separator">(</span><span class="java_literal">&quot;smtp1.example2.com&quot;</span><span class="java_separator">))</span><span class="java_plain">&nbsp;host&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;192.168.121.231&quot;</span><span class="java_separator">;</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">host</span><span class="java_separator">.</span><span class="java_plain">equals</span><span class="java_separator">(</span><span class="java_literal">&quot;smtp2.example2.com&quot;</span><span class="java_separator">))</span><span class="java_plain">&nbsp;host&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;192.168.121.232&quot;</span><span class="java_separator">;</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">((</span><span class="java_plain">host</span><span class="java_separator">.</span><span class="java_plain">equals</span><span class="java_separator">(</span><span class="java_literal">&quot;smtp.example2.com&quot;</span><span class="java_separator">))</span><span class="java_plain">&nbsp;</span><span class="java_operator">||</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">host</span><span class="java_separator">.</span><span class="java_plain">equals</span><span class="java_separator">(</span><span class="java_literal">&quot;mail.example2.com&quot;</span><span class="java_separator">)))</span><span class="java_plain">&nbsp;host&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_literal">&quot;192.168.121.230&quot;</span><span class="java_separator">;</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span><span class="java_plain"></span><br />
<span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">verbose</span><span class="java_separator">)</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">System</span><span class="java_separator">.</span><span class="java_plain">out</span><span class="java_separator">.</span><span class="java_plain">println</span><span class="java_separator">(</span><span class="java_literal">&quot;Connecting&nbsp;to&nbsp;&quot;</span><span class="java_operator">+</span><span class="java_plain">host</span><span class="java_separator">);</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_type">SSHConnection</span><span class="java_plain">&nbsp;conn&nbsp;</span><span class="java_operator">=</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">SSHConnection</span><span class="java_separator">(</span><span class="java_plain">orighost</span><span class="java_separator">,</span><span class="java_plain">&nbsp;host</span><span class="java_separator">,</span><span class="java_plain">&nbsp;port</span><span class="java_separator">,</span><span class="java_plain">&nbsp;parent</span><span class="java_separator">,</span><span class="java_plain">&nbsp;auth</span><span class="java_separator">);</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conn</span><span class="java_separator">.</span><span class="java_plain">connect</span><span class="java_separator">();</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;conn</span><span class="java_separator">.</span><span class="java_plain">authenticate</span><span class="java_separator">(</span><span class="java_plain">user</span><span class="java_separator">);</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;conn</span><span class="java_separator">;</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span><span class="java_plain"></span><br />
<span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_comment">/*&nbsp;User&nbsp;requested&nbsp;interactive&nbsp;session.&nbsp;host&nbsp;parameter&nbsp;contains&nbsp;host&nbsp;name&nbsp;as&nbsp;passed&nbsp;to&nbsp;command&nbsp;line&nbsp;(which</span><br />
<span class="java_comment">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;can&nbsp;be&nbsp;different&nbsp;from&nbsp;conn.getHost(),&nbsp;since&nbsp;we&nbsp;could&nbsp;have&nbsp;it&nbsp;rewritten&nbsp;by&nbsp;the&nbsp;function&nbsp;above*/</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">public</span><span class="java_plain">&nbsp;</span><span class="java_type">InteractiveSession</span><span class="java_plain">&nbsp;getInteractiveSession</span><span class="java_separator">(</span><span class="java_type">SSHConnection</span><span class="java_plain">&nbsp;conn</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;username</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">PasswordAuthenticator</span><span class="java_plain">&nbsp;pass</span><span class="java_separator">,</span><span class="java_plain">&nbsp;</span><span class="java_type">String</span><span class="java_plain">&nbsp;host</span><span class="java_separator">)</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_comment">//&nbsp;considering&nbsp;InteractiveSuSession&nbsp;only&nbsp;if&nbsp;we&nbsp;want&nbsp;to&nbsp;log&nbsp;in&nbsp;as&nbsp;root</span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">username</span><span class="java_separator">.</span><span class="java_plain">equals</span><span class="java_separator">(</span><span class="java_literal">&quot;root&quot;</span><span class="java_separator">))</span><span class="java_plain">&nbsp;</span><span class="java_separator">{</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_comment">//&nbsp;these&nbsp;machines&nbsp;have&nbsp;permitrootlogin&nbsp;disabled&nbsp;and&nbsp;we&nbsp;are&nbsp;authenticated&nbsp;as&nbsp;user&nbsp;adminuser,&nbsp;not&nbsp;root</span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">if</span><span class="java_plain">&nbsp;</span><span class="java_separator">((</span><span class="java_plain">host</span><span class="java_separator">.</span><span class="java_plain">equals</span><span class="java_separator">(</span><span class="java_literal">&quot;machine3.example.com&quot;</span><span class="java_separator">))</span><span class="java_plain">&nbsp;</span><span class="java_operator">||</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">host</span><span class="java_separator">.</span><span class="java_plain">equals</span><span class="java_separator">(</span><span class="java_literal">&quot;machine4.example.com&quot;</span><span class="java_separator">))</span><span class="java_plain">&nbsp;</span><span class="java_operator">||</span><span class="java_plain">&nbsp;</span><span class="java_separator">(</span><span class="java_plain">host</span><span class="java_separator">.</span><span class="java_plain">equals</span><span class="java_separator">(</span><span class="java_literal">&quot;machine5.example.com&quot;</span><span class="java_separator">)))</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">InteractiveSuSession</span><span class="java_separator">(</span><span class="java_plain">conn</span><span class="java_separator">.</span><span class="java_plain">openSession</span><span class="java_separator">(),</span><span class="java_plain">&nbsp;host</span><span class="java_separator">,</span><span class="java_plain">&nbsp;username</span><span class="java_separator">,</span><span class="java_plain">&nbsp;pass</span><span class="java_separator">);</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_comment">//&nbsp;other&nbsp;users&nbsp;are&nbsp;authenticated&nbsp;normally&nbsp;and&nbsp;we&nbsp;create&nbsp;normal&nbsp;interactive&nbsp;session&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_keyword">return</span><span class="java_plain">&nbsp;</span><span class="java_keyword">new</span><span class="java_plain">&nbsp;</span><span class="java_type">InteractiveSession</span><span class="java_separator">(</span><span class="java_plain">conn</span><span class="java_separator">.</span><span class="java_plain">openSession</span><span class="java_separator">());</span><span class="java_plain"></span><br />
<span class="java_plain">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="java_separator">}</span><span class="java_plain"></span><br />
<span class="java_plain"></span><br />
<span class="java_separator">}</span><span class="java_plain"></span><br />
<span class="java_plain"></span><br />
</code>
</body>
</html>
